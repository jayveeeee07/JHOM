<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Home ‚Äî Jayvee Hall of Mansion</title>
  <link rel="stylesheet" href="index.css">
  <style>
    /* Minimal additional styles for homepage cards */
    .section-card{ background:var(--card); padding:14px; border-radius:12px; box-shadow:var(--shadow); margin-bottom:12px; }
    .section-row{ display:flex; gap:12px; flex-direction:column; }
    .item { padding:10px 8px; border-bottom:1px solid #f2f4f7; }
    .item:last-child{ border-bottom:none; }
    .meta{ color:var(--muted); font-size:13px; }
    .view-more{ margin-top:8px; background:transparent; border:none; color:var(--primary); font-weight:700; cursor:pointer; }
  </style>
</head>
<body>
  <!-- Side Menu -->
  <div id="sideMenu" class="side-menu">
    <span class="close-btn" onclick="closeMenu()">&times;</span>
    <a href="https://www.facebook.com/JaysGumcar" target="_blank">üîµ Facebook</a>
    <a href="https://www.instagram.com/JaysGumcar" target="_blank">üì∏ Instagram</a>
    <a href="https://www.thread.com/JaysGumcar" target="_blank">üßµ Thread</a>
    <a href="mailto:jayveecaringal07@gmail.com">‚úâÔ∏è Email</a>
    <a href="https://www.telegram.com/JaysGumcar" target="_blank">üì® Telegram</a>
    <a href="about.html">‚ÑπÔ∏è About</a>
  </div>

  <!-- Navigation -->
  <nav>
    <div style="display:flex; align-items:center;">
      <span class="menu-icon" onclick="openMenu()">‚ò∞</span>
      <a class="brand" href="home.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit;">
        <img src="logo.jpg" alt="logo" style="width:44px;height:44px;border-radius:10px;object-fit:cover">
        <div>
          <h1 style="margin:0;font-size:16px">JAYVEE HALL OF MANSION</h1>
        </div>
      </a>
    </div>
    <div>
      <a href="home.html" class="active">HOME</a>
      <a href="room.html">ROOM</a>
      <a href="cart.html">CART</a>
      <a href="message.html">MESSAGE</a>
      <a href="notification.html">NOTIFICATION</a>
      <a href="adminpanel.html">ADMIN</a>
    </div>
  </nav>

  <main class="container" style="padding-top:16px;">
    <header class="header card">
      <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
        <div>
          <h2 style="margin:0">Latest Updates, News & Promotions</h2>
          <div class="kv">Stay informed ‚Äî recent announcements and exclusive promos for guests.</div>
        </div>
        <div style="width:100px">
          <img src="logo.jpg" alt="logo" style="width:100%;border-radius:12px;object-fit:cover">
        </div>
      </div>
    </header>

    <section style="margin-top:18px">
      <!-- Updates -->
      <div class="section-card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0">üè® Updates</h3>
          <button id="updatesViewMore" class="view-more" onclick="toggleMore('updates')">View More</button>
        </div>
        <div id="updatesList" class="section-row"></div>
      </div>

      <!-- News -->
      <div class="section-card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0">üì∞ News</h3>
          <button id="newsViewMore" class="view-more" onclick="toggleMore('news')">View More</button>
        </div>
        <div id="newsList" class="section-row"></div>
      </div>

      <!-- Events -->
      <div class="section-card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0">üìÖ Upcoming Events</h3>
          <button id="eventsViewMore" class="view-more" onclick="toggleMore('events')">View More</button>
        </div>
        <div id="eventsList" class="section-row"></div>
      </div>

      <!-- Promos -->
      <div class="section-card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0">üíé Special Promos</h3>
          <button id="promosViewMore" class="view-more" onclick="toggleMore('promos')">View More</button>
        </div>
        <div id="promosList" class="section-row"></div>
      </div>
    </section>

    <div style="height:18px"></div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="small-muted">Check updates regularly ‚Äî best rates and friendly staff await.</div>
      <div class="kv">¬© Jayvee Hall of Mansion</div>
    </div>
  </footer>

  <script>
    function openMenu(){ document.getElementById('sideMenu').style.width='250px' }
    function closeMenu(){ document.getElementById('sideMenu').style.width='0' }

    // store fetched data
    let siteData = null;
    const visibleLimit = 3;
    const expanded = { updates:false, news:false, events:false, promos:false };

    // fetch data from server.php (which returns data.json)
    function fetchData(){
      fetch('server.php')
        .then(r => r.json())
        .then(data => {
          siteData = data;
          renderSection('updates');
          renderSection('news');
          renderSection('events');
          renderSection('promos');
        })
        .catch(err => {
          console.error(err);
          document.getElementById('updatesList').innerHTML = '<div class="kv">Unable to load updates.</div>';
        });
    }

    function renderSection(section){
      const container = document.getElementById(section + 'List');
      container.innerHTML = '';
      if(!siteData || !siteData[section] || !siteData[section].length){
        container.innerHTML = '<div class="kv">No entries yet.</div>';
        return;
      }

      const items = siteData[section];
      const showAll = expanded[section];
      const list = showAll ? items : items.slice(-visibleLimit).reverse(); // show latest items
      // if showAll we show all in reverse chronological order (last entries last added)
      const displayList = showAll ? items.slice().reverse() : list;

      displayList.forEach(it=>{
        const el = document.createElement('div');
        el.className = 'item';
        el.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:flex-start">
                          <div>
                            <div style="font-weight:800">${escapeHtml(it.title)}</div>
                            <div class="meta">${escapeHtml(it.description)}</div>
                          </div>
                          <div class="meta">${escapeHtml(it.date||'')}</div>
                        </div>`;
        container.appendChild(el);
      });

      // update button text
      const btn = document.getElementById(section + 'ViewMore');
      if(expanded[section]){
        btn.textContent = 'Show Less';
      } else {
        btn.textContent = 'View More';
      }
    }

    function toggleMore(section){
      expanded[section] = !expanded[section];
      renderSection(section);
    }

    // very small escape helper
    function escapeHtml(text){
      if(!text) return '';
      return String(text)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    // initial load
    fetchData();
    // reload periodically (optional)
    setInterval(fetchData, 120000); // refresh every 2 minutes
  </script>
</body>
</html>

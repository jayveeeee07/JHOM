
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Panel ‚Äî JHOM</title>
  <link rel="stylesheet" href="index.css">

  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0; padding: 0;
      font-family: Arial, sans-serif;
      background: #e6f0ff;
      color: #003366;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    /* Container */
    main.container {
      flex: 1;
      max-width: 1200px;
      margin: auto;
      padding: 0 16px 80px; /* padding bottom for footer */
    }

    /* Header */
    header.header {
      background: linear-gradient(90deg, #004080, #cc0000);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 16px;
      flex-wrap: wrap;
      position: sticky;
      top: 0;
      z-index: 999;
    }
    header.header a.brand {
      display: flex;
      align-items: center;
      gap: 12px;
      color: white;
    }
    header.header a.brand img {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      object-fit: contain;
    }
    header.header a.brand h1 {
      font-size: 1.4rem;
      margin: 0;
      white-space: nowrap;
    }
    .nav {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      align-items: center;
    }
    .nav a {
      color: white;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 6px;
      transition: background-color 0.3s ease;
    }
    .nav a:hover, .nav a.active {
      background: #cc0000;
    }
    .icon-btn {
      font-size: 1.4rem;
      background: transparent;
      border: none;
      color: white;
      cursor: pointer;
      padding: 6px 10px;
      border-radius: 6px;
      display: none;
    }

    /* Card Section */
    section.card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-top: 16px;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
    }
    section.card h3 {
      margin-top: 0;
      margin-bottom: 8px;
      color: #004080;
    }
    section.card p.small {
      font-size: 0.9rem;
      color: #555;
    }

    /* Form */
    form#loginForm {
      max-width: 420px;
    }
    .form-row {
      margin-bottom: 16px;
    }
    input.input {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    input.input:focus {
      outline: none;
      border-color: #004080;
    }

    /* Buttons */
    .btn {
      cursor: pointer;
      border: none;
      padding: 10px 18px;
      border-radius: 6px;
      font-weight: 600;
      transition: background-color 0.3s ease;
    }
    .btn-primary {
      background-color: #004080;
      color: white;
    }
    .btn-primary:hover {
      background-color: #003060;
    }
    .btn-outline {
      background-color: transparent;
      border: 2px solid #004080;
      color: #004080;
    }
    .btn-outline:hover {
      background-color: #004080;
      color: white;
    }

    /* Admin grid */
    .admin-grid {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-top: 12px;
    }
    .admin-grid > div {
      flex: 1 1 45%;
      min-width: 300px;
      background: #f2f7ff;
      border-radius: 10px;
      padding: 12px;
      box-shadow: inset 0 0 10px #d0dff7;
    }

    /* Tables */
    table.table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
      color: #003366;
    }
    table.table thead tr {
      background: #004080;
      color: white;
    }
    table.table th, table.table td {
      padding: 8px 10px;
      border: 1px solid #ccc;
      text-align: left;
      vertical-align: middle;
    }
    table.table tbody tr:hover {
      background-color: #e6f0ff;
    }
    table.table img {
      border-radius: 8px;
      object-fit: cover;
    }

    /* Messages */
    #adminMsgs > .card {
      background: white;
      padding: 12px 16px;
      margin-bottom: 12px;
      border-radius: 8px;
      box-shadow: 0 1px 6px rgb(0 0 0 / 0.1);
    }
    #adminMsgs strong {
      font-size: 1.1rem;
    }
    .kv {
      font-size: 0.85rem;
      color: #666;
    }
    .badge {
      background: #cc0000;
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 700;
    }
    textarea.input {
      width: 100%;
      min-height: 60px;
      resize: vertical;
      margin-top: 8px;
      padding: 8px 10px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    /* Side menu */
    aside.side-menu {
      position: fixed;
      top: 0; right: -260px;
      width: 260px;
      height: 100vh;
      background: #004080;
      color: white;
      padding: 16px;
      box-shadow: -3px 0 6px rgba(0,0,0,0.2);
      transition: right 0.3s ease;
      z-index: 1500;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    aside.side-menu.open {
      right: 0;
    }
    aside.side-menu strong {
      font-size: 1.2rem;
      margin-bottom: 16px;
    }
    aside.side-menu .socials a {
      display: block;
      margin-bottom: 12px;
      font-weight: 600;
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      background: #0066cc;
      transition: background-color 0.3s ease;
    }
    aside.side-menu .socials a:hover {
      background: #003366;
    }
    #closeMenu {
      background: transparent;
      border: none;
      font-size: 1.4rem;
      color: white;
      cursor: pointer;
      align-self: flex-end;
      margin-top: -12px;
      margin-bottom: 12px;
    }

    /* Footer */
    footer.footer {
      background: #004080;
      color: white;
      text-align: center;
      padding: 14px 16px;
      font-size: 0.9rem;
      position: sticky;
      bottom: 0;
      width: 100%;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.2);
      flex-shrink: 0;
    }
    footer.footer .kv {
      font-weight: 600;
      margin-top: 4px;
    }

    /* Responsive */
    @media (max-width: 800px) {
      .admin-grid {
        flex-direction: column;
      }
      .nav {
        width: 100%;
        justify-content: space-between;
      }
      .icon-btn {
        display: inline-block;
      }
    }
  </style>
</head>
<body>
<main class="container">
  <header class="header">
    <a class="brand" href="home.html"><img src="logo.jpg" alt="logo"><div><h1>JAYVEE HALL OF MANSION</h1></div></a>
    <div class="nav">
      <a href="home.html">HOME</a>
      <a href="room.html">ROOM</a>
      <a href="cart.html">CART</a>
      <a href="message.html">MESSAGE</a>
      <a href="notification.html">NOTIFICATION</a>
      <a href="adminpanel.html" class="active">ADMIN</a>
      <button class="icon-btn" id="menuBtn">‚ò∞</button>
    </div>
  </header>

  <section class="card">
    <h3>Administrator Login</h3>
    <form id="loginForm" style="max-width:420px">
      <div class="form-row"><input class="input" id="username" placeholder="Username" required></div>
      <div class="form-row"><input class="input" id="password" placeholder="Password" type="password" required></div>
      <div style="display:flex;gap:8px"><button class="btn btn-primary" type="submit">Login</button></div>
    </form>
  </section>

  <div id="adminArea" style="display:none; margin-top:16px">
    <section class="card">
      <h3>Administrator Dashboard</h3>
      <p class="small">Manage users, bookings and messages.</p>

      <div class="admin-grid">
        <div>
          <h4>Registered Users</h4>
          <table class="table" id="usersTable"><thead><tr><th>Photo</th><th>Name</th><th>Email</th><th>Contact</th><th>Status</th></tr></thead><tbody></tbody></table>
        </div>

        <div>
          <h4>Bookings</h4>
          <table class="table" id="bookingsTable"><thead><tr><th>Image</th><th>Name</th><th>Check-in</th><th>Price</th><th>Proof</th><th>Status</th><th>Action</th></tr></thead><tbody></tbody></table>
        </div>
      </div>

      <div style="margin-top:12px">
        <h4>Messages</h4>
        <div id="adminMsgs"></div>
      </div>
    </section>

    <!-- NEW: Content Management Sections -->
    <section class="card">
      <h3>Manage Updates, News, Events & Promos</h3>
      <p class="small">Add, edit or remove public posts for the home page.</p>

      <div id="contentSections"></div>
    </section>
  </div>
</main>

<aside class="side-menu" id="sideMenu">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <strong>Connect</strong>
    <button class="icon-btn" id="closeMenu">‚úï</button>
  </div>
  <div class="socials">
    <a href="https://www.facebook.com/JaysGumcar" target="_blank">üîµ Facebook</a>
    <a href="https://www.instagram.com/JaysGumcar" target="_blank">üì∏ Instagram</a>
    <a href="https://www.thread.com/JaysGumcar" target="_blank">üßµ Thread</a>
    <a href="mailto:jayveecaringal07@gmail.com" target="_blank">‚úâÔ∏è Email</a>
    <a href="https://www.telegram.com/JaysGumcar" target="_blank">üì® Telegram</a>
    <a href="About.html">‚ÑπÔ∏è About</a>
  </div>
</aside>

<footer class="footer">
  <div class="container">
    <div class="small-muted">Admin actions update notifications and messages for users automatically.</div>
    <div class="kv">JHOM Admin</div>
  </div>
</footer>

<script>
document.getElementById('menuBtn').addEventListener('click', ()=> document.getElementById('sideMenu').classList.add('open'));
document.getElementById('closeMenu').addEventListener('click', ()=> document.getElementById('sideMenu').classList.remove('open'));

// login
const loginForm = document.getElementById('loginForm');
loginForm.addEventListener('submit', e=>{
  e.preventDefault();
  const user = document.getElementById('username').value.trim();
  const pass = document.getElementById('password').value.trim();
  if(user==='JHOM' && pass==='ADMIN'){
    document.getElementById('adminArea').style.display='block';
    loginForm.style.display='none';
    loadAdminData();
    loadContentSections();
  } else alert('Invalid credentials');
});

function loadAdminData(){
  // users
  const users = JSON.parse(localStorage.getItem('users')||'[]');
  const uT = document.querySelector('#usersTable tbody');
  uT.innerHTML = (users.length? users.map(u=>`<tr><td><img src="${u.photo||'logo.jpg'}" style="width:44px;height:44px;border-radius:8px;object-fit:cover"></td><td>${u.name}</td><td>${u.email}</td><td>${u.contact||'‚Äî'}</td><td>${u.status||'Active'}</td></tr>`).join('') : '<tr><td colspan="5">No registered users.</td></tr>');

  // bookings
  const bookings = JSON.parse(localStorage.getItem('bookings')||'[]');
  const bT = document.querySelector('#bookingsTable tbody');
  bT.innerHTML = (bookings.length? bookings.map((b,idx)=>`
    <tr>
      <td><img src="${b.room.img}" style="width:80px;height:44px;object-fit:cover"></td>
      <td>${b.name}</td>
      <td>${b.date}</td>
      <td>‚Ç± ${Number(b.room.price).toLocaleString()}</td>
      <td>${b.proof ? `<a href="${b.proof}" target="_blank">View</a>` : '‚Äî'}</td>
      <td>${b.status}</td>
      <td>
        <button class="btn btn-outline" data-i="${idx}" data-act="approve">Approve</button>
        <button class="btn btn-outline" data-i="${idx}" data-act="reject">Reject</button>
        <button class="btn btn-primary" data-i="${idx}" data-act="view">View</button>
      </td>
    </tr>
  `).join('') : '<tr><td colspan="7">No bookings yet.</td></tr>');
  attachBookingActions();

  // messages
  const msgs = JSON.parse(localStorage.getItem('messages')||'[]');
  const adminMsgs = document.getElementById('adminMsgs');
  adminMsgs.innerHTML = (msgs.length? msgs.map((m,idx)=>`
    <div class="card" style="margin-bottom:8px">
      <div style="display:flex;justify-content:space-between"><div><strong>${m.name}</strong><div class="kv">${m.email} ‚Ä¢ ${m.date}</div></div><div class="badge">${m.ref}</div></div>
      <div style="margin-top:8px">${m.body||'<em>No body</em>'}</div>
      <div style="margin-top:8px">
        <textarea class="input" id="reply-${idx}" placeholder="Reply to user"></textarea>
        <div style="margin-top:8px"><button class="btn btn-primary" data-i="${idx}" data-act="reply">SEND</button></div>
      </div>
    </div>
  `).join('') : '<div class="kv">No messages</div>');

  document.querySelectorAll('button[data-act="reply"]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const idx = +b.dataset.i;
      const val = document.getElementById(`reply-${idx}`).value.trim();
      if(!val){ alert('Type a reply'); return;}
      const msgs = JSON.parse(localStorage.getItem('messages')||'[]');
      msgs[idx].adminReply = val;
      localStorage.setItem('messages', JSON.stringify(msgs));
      alert('Reply sent to user inbox');
      loadAdminData();
    });
  });
}

function attachBookingActions(){
  document.querySelectorAll('button[data-act]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const idx = +b.dataset.i;
      const act = b.dataset.act;
      const bookings = JSON.parse(localStorage.getItem('bookings')||'[]');
      if(!bookings[idx]) return;
      if(act==='approve'){
        bookings[idx].status = 'Approved';
        bookings[idx].pin = Math.random().toString(36).slice(2,10).toUpperCase();
        localStorage.setItem('bookings', JSON.stringify(bookings));
        alert('Booking approved and notification sent.');
      } else if(act==='reject'){
        bookings[idx].status = 'Rejected';
        localStorage.setItem('bookings', JSON.stringify(bookings));
        alert('Booking rejected.');
      } else if(act==='view'){
        alert(JSON.stringify(bookings[idx],null,2));
      }
      loadAdminData();
    });
  });
}

// ========================
// NEW CONTENT MANAGEMENT
// ========================
function loadContentSections(){
  const types = ['Updates','News','Events','Promos'];
  const container = document.getElementById('contentSections');
  container.innerHTML = types.map(type=>`
    <div class="card" style="margin-top:12px">
      <h4>${type}</h4>
      <form data-type="${type}" class="contentForm" style="margin-bottom:8px">
        <input class="input" name="title" placeholder="Title" required>
        <textarea class="input" name="desc" placeholder="Description" required></textarea>
        <input class="input" name="date" type="date" required>
        <input class="input" name="image" type="file" accept="image/*">
        <button class="btn btn-primary" type="submit">Add ${type}</button>
      </form>
      <div id="${type}List" class="kv small"></div>
    </div>
  `).join('');

  document.querySelectorAll('.contentForm').forEach(form=>{
    form.addEventListener('submit', e=>{
      e.preventDefault();
      const type = form.dataset.type;
      const storeKey = `content_${type}`;
      const existing = JSON.parse(localStorage.getItem(storeKey)||'[]');

      const title = form.title.value.trim();
      const desc = form.desc.value.trim();
      const date = form.date.value;
      const file = form.image.files[0];

      if(file){
        const reader = new FileReader();
        reader.onload = ev=>{
          existing.push({title,desc,date,img:ev.target.result});
          localStorage.setItem(storeKey, JSON.stringify(existing));
          form.reset();
          loadContentSections();
        };
        reader.readAsDataURL(file);
      } else {
        existing.push({title,desc,date,img:''});
        localStorage.setItem(storeKey, JSON.stringify(existing));
        form.reset();
        loadContentSections();
      }
    });
  });

  types.forEach(type=>{
    const list = JSON.parse(localStorage.getItem(`content_${type}`)||'[]');
    const target = document.getElementById(`${type}List`);
    target.innerHTML = list.length ? list.map((item,i)=>`
      <div style="margin-bottom:6px">
        ${item.img? `<img src="${item.img}" style="width:60px;height:40px;object-fit:cover;border-radius:4px;margin-right:6px">` : ''}
        <strong>${item.title}</strong> (${item.date})
        <div class="small">${item.desc}</div>
        <button class="btn btn-outline" onclick="deleteContent('${type}',${i})">Delete</button>
      </div>
    `).join('') : `<em>No ${type} yet.</em>`;
  });
}

function deleteContent(type, idx){
  const key = `content_${type}`;
  const list = JSON.parse(localStorage.getItem(key)||'[]');
  list.splice(idx,1);
  localStorage.setItem(key, JSON.stringify(list));
  loadContentSections();
}
<h2>Bookings</h2>
<div id="bookingList"></div>

<script>
  const bookingList = document.getElementById('bookingList');
  const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');

  if (bookings.length === 0) {
    bookingList.textContent = 'No bookings yet.';
  } else {
    bookings.forEach((b, i) => {
      const div = document.createElement('div');
      div.className = 'booking-item';
      div.style.border = '1px solid #ddd';
      div.style.padding = '1rem';
      div.style.marginBottom = '1rem';
      div.innerHTML = `
        <h3>Booking ${i + 1}</h3>
        <p><strong>Name:</strong> ${b.fullName}</p>
        <p><strong>Room Number:</strong> ${b.roomNumber}</p>
        <p><strong>Check-In:</strong> ${b.checkIn}</p>
        <p><strong>Payment Method:</strong> ${b.paymentMethod}</p>
        <p><strong>Ticket Ref:</strong> ${b.ticketRef}</p>
        <p><strong>Price:</strong> ‚Ç±${b.roomPrice}</p>
      `;
      bookingList.appendChild(div);
    });
  }
</script>
</body>
</html>
